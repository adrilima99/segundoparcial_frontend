import{b as D,c as T,f as L,m as W}from"./chunk-5TRB5RNR.js";import{a as U}from"./chunk-IL2UONYL.js";import{c as V}from"./chunk-C5J56EWV.js";import{$a as n,Ka as o,La as w,Va as h,Ya as g,ab as i,bb as M,cc as O,dc as B,e as A,eb as C,ec as I,fa as v,fb as u,gb as l,gc as k,mb as r,nb as m,oa as d,pa as p,pb as P,rb as _,sb as x,tb as b,vb as S,yb as E,zb as F}from"./chunk-RI4DZ32I.js";var j=A(U());function H(a,f){a&1&&(n(0,"div",2),M(1,"div",3),i())}function R(a,f){if(a&1&&(n(0,"tr",17)(1,"td",14),r(2),i(),n(3,"td",14),r(4),i(),n(5,"td",14),r(6),i(),n(7,"td",14),r(8),E(9,"date"),i(),n(10,"td",14),r(11),i(),n(12,"td",14),r(13),i()()),a&2){let t=f.$implicit;o(2),P("",t.usuario_nombre," (",t.username,")"),o(2),m(t.accion),o(2),m(t.modulo||"-"),o(2),m(F(9,7,t.fecha,"short")),o(3),m(t.ip_origen||"-"),o(2),m(t.dispositivo||"-")}}function q(a,f){if(a&1){let t=C();n(0,"div",18)(1,"button",19),u("click",function(){d(t);let e=l(2);return p(e.prevPage())}),r(2,"Anterior"),i(),n(3,"span",20),r(4),i(),n(5,"button",19),u("click",function(){d(t);let e=l(2);return p(e.nextPage())}),r(6,"Siguiente"),i()()}if(a&2){let t=l(2);o(),g("disabled",t.currentPage===1),o(3),P("P\xE1gina ",t.currentPage," de ",t.totalPages(),""),o(),g("disabled",t.currentPage===t.totalPages())}}function G(a,f){if(a&1){let t=C();n(0,"div",4)(1,"h1",5),r(2,"Bit\xE1cora del Sistema"),i(),n(3,"div",6)(4,"input",7),b("ngModelChange",function(e){d(t);let s=l();return x(s.username,e)||(s.username=e),p(e)}),i(),n(5,"input",8),b("ngModelChange",function(e){d(t);let s=l();return x(s.fechaInicio,e)||(s.fechaInicio=e),p(e)}),i(),n(6,"input",8),b("ngModelChange",function(e){d(t);let s=l();return x(s.fechaFin,e)||(s.fechaFin=e),p(e)}),i(),n(7,"button",9),u("click",function(){d(t);let e=l();return p(e.aplicarFiltros())}),r(8," \u{1F50D} Buscar "),i(),n(9,"button",10),u("click",function(){d(t);let e=l();return p(e.limpiarFiltros())}),r(10," \u274C Limpiar "),i()(),n(11,"div",11)(12,"table",12)(13,"thead",13)(14,"tr")(15,"th",14),r(16,"Usuario"),i(),n(17,"th",14),r(18,"Acci\xF3n"),i(),n(19,"th",14),r(20,"M\xF3dulo"),i(),n(21,"th",14),r(22,"Fecha"),i(),n(23,"th",14),r(24,"IP"),i(),n(25,"th",14),r(26,"Dispositivo"),i()()(),n(27,"tbody"),h(28,R,14,10,"tr",15),i()()(),h(29,q,7,4,"div",16),i()}if(a&2){let t=l();o(4),_("ngModel",t.username),o(),_("ngModel",t.fechaInicio),o(),_("ngModel",t.fechaFin),o(22),g("ngForOf",t.paginatedBitacoras()),o(),g("ngIf",t.totalPages()>1)}}var $=(()=>{class a{constructor(t){this.http=t,this.bitacoras=[],this.bitacorasFiltradas=[],this.isLoading=!1,this.currentPage=1,this.itemsPerPage=10,this.fechaInicio="",this.fechaFin="",this.username=""}ngOnInit(){this.loadBitacoras()}loadBitacoras(){this.isLoading=!0,this.http.get("http://137.184.94.190/api/bitacora/").subscribe({next:t=>{this.bitacoras=t,this.aplicarFiltros(),this.isLoading=!1},error:t=>{this.isLoading=!1,j.default.fire("Error","No se pudieron cargar las bit\xE1coras","error"),console.error(t)}})}aplicarFiltros(){let t=this.fechaInicio?new Date(this.fechaInicio):null,c=this.fechaFin?new Date(this.fechaFin):null,e=this.username.toLowerCase();this.bitacorasFiltradas=this.bitacoras.filter(s=>{let y=new Date(s.fecha),N=!e||s.username.toLowerCase().includes(e),z=(!t||y>=t)&&(!c||y<=c);return N&&z}),this.currentPage=1}limpiarFiltros(){this.fechaInicio="",this.fechaFin="",this.username="",this.bitacorasFiltradas=[...this.bitacoras],this.currentPage=1}paginatedBitacoras(){let t=(this.currentPage-1)*this.itemsPerPage;return this.bitacorasFiltradas.slice(t,t+this.itemsPerPage)}totalPages(){return Math.ceil(this.bitacorasFiltradas.length/this.itemsPerPage)}nextPage(){this.currentPage<this.totalPages()&&this.currentPage++}prevPage(){this.currentPage>1&&this.currentPage--}static{this.\u0275fac=function(c){return new(c||a)(w(V))}}static{this.\u0275cmp=v({type:a,selectors:[["app-bitacora"]],standalone:!0,features:[S],decls:2,vars:2,consts:[["class","spinner-container",4,"ngIf"],["class","container mx-auto px-4 py-8",4,"ngIf"],[1,"spinner-container"],[1,"spinner"],[1,"container","mx-auto","px-4","py-8"],[1,"text-3xl","font-bold","text-gray-800","mb-4"],[1,"flex","flex-wrap","gap-4","items-center","mb-6"],["type","text","placeholder","Buscar por username",1,"px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:border-purple-500",3,"ngModelChange","ngModel"],["type","date",1,"px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:border-purple-500",3,"ngModelChange","ngModel"],[1,"bg-purple-600","hover:bg-purple-700","text-white","px-4","py-2","rounded-lg",3,"click"],[1,"bg-gray-500","hover:bg-gray-600","text-white","px-4","py-2","rounded-lg",3,"click"],[1,"overflow-x-auto"],[1,"min-w-full","bg-white","rounded-lg","shadow","text-sm"],[1,"bg-gray-800","text-white"],[1,"p-3"],["class","hover:bg-gray-50 border-b",4,"ngFor","ngForOf"],["class","mt-6 flex justify-end items-center gap-2",4,"ngIf"],[1,"hover:bg-gray-50","border-b"],[1,"mt-6","flex","justify-end","items-center","gap-2"],[1,"px-3","py-1","rounded","bg-gray-200","hover:bg-gray-300","disabled:opacity-50",3,"click","disabled"],[1,"text-sm","font-medium","text-gray-700"]],template:function(c,e){c&1&&h(0,H,2,0,"div",0)(1,G,30,5,"div",1),c&2&&(g("ngIf",e.isLoading),o(),g("ngIf",!e.isLoading))},dependencies:[k,O,B,I,W,D,T,L],styles:[".spinner-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#000c;display:flex;justify-content:center;align-items:center;z-index:1000}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid #ffffff;border-radius:50%;width:50px;height:50px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:20px;font-size:.95rem}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#343a40;color:#fff}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #dee2e6;padding:12px;text-align:left}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f8f9fa}button[_ngcontent-%COMP%]{padding:10px 20px;border-radius:8px;font-weight:700;cursor:pointer;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{opacity:.9}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%], input[type=file][_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:10px;border-radius:8px;border:1px solid #ccc;background-color:#f3f4f6}.spinner-modal[_ngcontent-%COMP%]{position:absolute;inset:0;background-color:#00000080;z-index:50;display:flex;justify-content:center;align-items:center;border-radius:1rem}@media (max-width: 768px){table[_ngcontent-%COMP%]{font-size:14px}button[_ngcontent-%COMP%]{width:100%;margin-top:10px}.grid-cols-2[_ngcontent-%COMP%], .md\\:grid-cols-2[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}"]})}}return a})();export{$ as BitacoraComponent};
