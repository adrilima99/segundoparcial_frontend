import{b as T,c as L,f as W,m as j}from"./chunk-5TRB5RNR.js";import{a as R}from"./chunk-IL2UONYL.js";import{c as N}from"./chunk-C5J56EWV.js";import{$a as t,Ka as a,La as V,Va as x,Ya as u,ab as n,bb as w,cc as O,dc as P,e as A,eb as g,ec as D,fa as y,fb as h,gb as d,gc as k,mb as i,nb as c,oa as p,ob as M,pa as m,pb as C,qb as E,rb as _,sb as b,tb as v,vb as S,yb as I,zb as F}from"./chunk-RI4DZ32I.js";var B=A(R());function $(r,f){r&1&&(t(0,"div",3),w(1,"div",4),n())}function q(r,f){if(r&1){let e=g();t(0,"tr",18)(1,"td",16),i(2),n(),t(3,"td",16),i(4),w(5,"br"),t(6,"span",19),i(7),n()(),t(8,"td",16),i(9),I(10,"date"),n(),t(11,"td",16),i(12),n(),t(13,"td",16),i(14),n(),t(15,"td",16),i(16),n(),t(17,"td",16)(18,"button",20),h("click",function(){let o=p(e).$implicit,l=d(2);return m(l.verDetalles(o))}),i(19," Ver productos "),n()()()}if(r&2){let e=f.$implicit;a(2),c(e.id),a(2),C(" ",e.usuario.first_name," ",e.usuario.last_name,""),a(3),c(e.usuario.email),a(2),c(F(10,8,e.fecha_venta,"short")),a(3),M("$ ",e.total,""),a(2),c(e.estado),a(2),c(e.tipo_pago.nombre||"N/A")}}function G(r,f){if(r&1){let e=g();t(0,"div",5)(1,"h1",6),i(2,"\u{1F9FE} Ventas Registradas"),n(),t(3,"div",7)(4,"div",8)(5,"label",9),i(6,"Nombre del cliente"),n(),t(7,"input",10),v("ngModelChange",function(o){p(e);let l=d();return b(l.filtroNombre,o)||(l.filtroNombre=o),m(o)}),n()(),t(8,"div",8)(9,"label",9),i(10,"Desde"),n(),t(11,"input",11),v("ngModelChange",function(o){p(e);let l=d();return b(l.fechaInicio,o)||(l.fechaInicio=o),m(o)}),n()(),t(12,"div",8)(13,"label",9),i(14,"Hasta"),n(),t(15,"input",11),v("ngModelChange",function(o){p(e);let l=d();return b(l.fechaFin,o)||(l.fechaFin=o),m(o)}),n()(),t(16,"button",12),h("click",function(){p(e);let o=d();return m(o.aplicarFiltros())}),i(17," \u{1F50D} Buscar "),n()(),t(18,"div",13)(19,"table",14)(20,"thead")(21,"tr",15)(22,"th",16),i(23,"#"),n(),t(24,"th",16),i(25,"Cliente"),n(),t(26,"th",16),i(27,"Fecha"),n(),t(28,"th",16),i(29,"Total"),n(),t(30,"th",16),i(31,"Estado"),n(),t(32,"th",16),i(33,"Tipo de Pago"),n(),t(34,"th",16),i(35,"Acciones"),n()()(),t(36,"tbody"),x(37,q,20,11,"tr",17),n()()()()}if(r&2){let e=d();a(7),_("ngModel",e.filtroNombre),a(4),_("ngModel",e.fechaInicio),a(4),_("ngModel",e.fechaFin),a(22),u("ngForOf",e.ventasFiltradas)}}function J(r,f){if(r&1&&(t(0,"li",29)(1,"span"),i(2),n(),t(3,"span"),i(4),n()()),r&2){let e=f.$implicit;a(2),c(e.producto.nombre),a(2),C("",e.cantidad," x $",e.precio_unitario,"")}}function K(r,f){if(r&1){let e=g();t(0,"div",21)(1,"div",22)(2,"h2",23),i(3),n(),t(4,"p",24),i(5),n(),t(6,"ul",25),x(7,J,5,3,"li",26),n(),t(8,"div",27)(9,"button",28),h("click",function(){p(e);let o=d();return m(o.cerrarModal())}),i(10," Cerrar "),n()()()()}if(r&2){let e=d();a(3),E(" Venta #",e.selectedVenta.id," - ",e.selectedVenta.usuario.first_name," ",e.selectedVenta.usuario.last_name," "),a(2),c(e.selectedVenta.usuario.email),a(2),u("ngForOf",e.selectedVenta.detalles)}}var te=(()=>{class r{constructor(e){this.http=e,this.ventas=[],this.ventasFiltradas=[],this.isLoading=!1,this.selectedVenta=null,this.showModal=!1,this.filtroNombre="",this.fechaInicio="",this.fechaFin=""}ngOnInit(){this.loadVentas()}loadVentas(){this.isLoading=!0,this.http.get("http://137.184.94.190/api/ventas/todas/").subscribe(e=>{this.ventas=e,this.ventasFiltradas=[...e],this.isLoading=!1},e=>{this.isLoading=!1,this.handleHttpError(e)})}aplicarFiltros(){this.ventasFiltradas=this.ventas.filter(e=>{let s=`${e.usuario.first_name} ${e.usuario.last_name}`.toLowerCase(),o=this.filtroNombre?s.includes(this.filtroNombre.toLowerCase()):!0,l=new Date(e.fecha_venta),z=this.fechaInicio?l>=new Date(this.fechaInicio):!0,H=this.fechaFin?l<=new Date(this.fechaFin):!0;return o&&z&&H})}verDetalles(e){this.selectedVenta=e,this.showModal=!0}cerrarModal(){this.showModal=!1,this.selectedVenta=null}handleHttpError(e){console.error("Error al cargar ventas:",e),B.default.fire("Error","No se pudieron cargar las ventas.","error")}static{this.\u0275fac=function(s){return new(s||r)(V(N))}}static{this.\u0275cmp=y({type:r,selectors:[["app-ventas"]],standalone:!0,features:[S],decls:3,vars:3,consts:[["class","spinner-container",4,"ngIf"],["class","container mx-auto px-4 py-8",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",4,"ngIf"],[1,"spinner-container"],[1,"spinner"],[1,"container","mx-auto","px-4","py-8"],[1,"text-3xl","font-bold","text-purple-900","mb-6"],[1,"bg-white","rounded-lg","shadow","p-4","mb-6","flex","flex-wrap","gap-4","items-end"],[1,"flex","flex-col"],[1,"text-sm","text-gray-600","mb-1"],["type","text","placeholder","Nombre o apellido",1,"px-3","py-2","border","rounded-md","focus:outline-none","focus:ring","focus:border-purple-500",3,"ngModelChange","ngModel"],["type","date",1,"px-3","py-2","border","rounded-md","focus:outline-none","focus:ring","focus:border-purple-500",3,"ngModelChange","ngModel"],[1,"bg-purple-600","hover:bg-purple-700","text-white","px-4","py-2","rounded-md","shadow",3,"click"],[1,"overflow-x-auto"],[1,"min-w-full","bg-white","rounded-lg","shadow","text-sm"],[1,"bg-gray-800","text-white","text-left"],[1,"p-3"],["class","hover:bg-gray-50 border-b",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50","border-b"],[1,"text-xs","text-gray-500"],[1,"px-3","py-1","bg-purple-600","hover:bg-purple-700","text-white","rounded","shadow","transition",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"bg-white","w-full","max-w-2xl","rounded-lg","shadow-lg","p-6","relative"],[1,"text-xl","font-bold","text-purple-700","mb-2"],[1,"text-sm","text-gray-600","mb-4"],[1,"space-y-2"],["class","flex justify-between",4,"ngFor","ngForOf"],[1,"mt-6","text-right"],[1,"px-4","py-2","bg-gray-500","hover:bg-gray-600","text-white","rounded",3,"click"],[1,"flex","justify-between"]],template:function(s,o){s&1&&x(0,$,2,0,"div",0)(1,G,38,4,"div",1)(2,K,11,5,"div",2),s&2&&(u("ngIf",o.isLoading),a(),u("ngIf",!o.isLoading),a(),u("ngIf",o.showModal&&o.selectedVenta))},dependencies:[k,O,P,D,j,T,L,W],styles:[".spinner-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#000c;display:flex;justify-content:center;align-items:center;z-index:1000}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid #ffffff;border-radius:50%;width:50px;height:50px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:20px}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#343a40;color:#fff}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #dee2e6;padding:12px;text-align:left}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f8f9fa}button[_ngcontent-%COMP%]{padding:10px 20px;border-radius:8px;font-weight:700;cursor:pointer;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{opacity:.9}@media (max-width: 768px){table[_ngcontent-%COMP%]{font-size:14px}button[_ngcontent-%COMP%]{width:100%;margin-top:10px}}"]})}}return r})();export{te as VentasComponent};
